<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Date Filter with Presets - Ui Element</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #020617;
      --card-bg: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.2);
      --border: rgba(148, 163, 184, 0.35);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --radius: 18px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 60%);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .wrapper {
      width: 100%;
      max-width: 680px;
    }

    .card {
      position: relative;
      border-radius: 26px;
      padding: 18px 18px 16px;
      border: 1px solid var(--border);
      background: radial-gradient(circle at top left, #111827 0, #020617 50%);
      box-shadow:
        0 18px 45px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(15, 23, 42, 1);
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -140px;
      background:
        radial-gradient(circle at top left, rgba(56, 189, 248, 0.06), transparent 60%),
        radial-gradient(circle at bottom right, rgba(129, 140, 248, 0.08), transparent 60%);
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .title-wrap {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .title {
      font-weight: 600;
      font-size: 1rem;
      letter-spacing: 0.02em;
    }

    .subtitle {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .badge {
      border-radius: 999px;
      padding: 4px 10px;
      border: 1px solid var(--border);
      font-size: 0.7rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    /* Presets */
    .presets {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 14px;
    }

    .preset-btn {
      border-radius: 999px;
      padding: 6px 10px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text);
      font-size: 0.8rem;
      cursor: pointer;
      outline: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .preset-btn span.dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #38bdf8;
      box-shadow: 0 0 8px rgba(56, 189, 248, 0.8);
    }

    .preset-btn.active {
      border-color: var(--accent);
      box-shadow: 0 0 20px rgba(56, 189, 248, 0.6);
      background: rgba(8, 47, 73, 0.9);
    }

    .preset-btn:active {
      transform: translateY(1px) scale(0.98);
    }

    /* Inputs row */
    .inputs-row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 10px;
    }

    @media (max-width: 640px) {
      .card {
        border-radius: 22px;
        padding: 16px 12px 12px;
      }
      .inputs-row {
        grid-template-columns: 1fr;
      }
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .label {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .pill-input {
      position: relative;
      border-radius: 999px;
      padding: 7px 30px 7px 10px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.95);
      font-size: 0.84rem;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      min-height: 32px;
    }

    .pill-input span {
      white-space: nowrap;
    }

    .pill-input.placeholder span {
      color: var(--muted);
    }

    .pill-icon {
      position: absolute;
      right: 9px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.9rem;
      opacity: 0.85;
      pointer-events: none;
    }

    .chip {
      border-radius: 999px;
      padding: 4px 9px;
      border: 1px dashed rgba(148, 163, 184, 0.7);
      font-size: 0.72rem;
      align-self: flex-start;
    }

    /* Footer */
    .footer {
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      font-size: 0.78rem;
      color: var(--muted);
      flex-wrap: wrap;
    }

    .apply-btn {
      border-radius: 999px;
      padding: 6px 16px;
      border: none;
      background: linear-gradient(to right, #38bdf8, #2563eb);
      color: #0b1120;
      font-size: 0.82rem;
      font-weight: 600;
      cursor: pointer;
      outline: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .apply-btn:active {
      transform: translateY(1px) scale(0.98);
    }

    /* Calendar popover */
    .popover {
      position: absolute;
      top: 100%;
      left: 0;
      margin-top: 6px;
      border-radius: 20px;
      border: 1px solid rgba(55, 65, 81, 0.95);
      background: rgba(15, 23, 42, 0.98);
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.95);
      transform-origin: top center;
      opacity: 0;
      transform: scale(0.94) translateY(-4px);
      visibility: hidden;
      transition:
        opacity 0.16s ease-out,
        transform 0.16s ease-out,
        visibility 0.16s;
      z-index: 10;
    }

    .popover.visible {
      opacity: 1;
      transform: scale(1) translateY(0);
      visibility: visible;
    }

    .popover-inner {
      padding: 8px 8px 9px;
      width: 260px;
    }

    .popover-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      padding: 4px 2px 6px;
    }

    .popover-label {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .month-nav {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .nav-btn {
      width: 24px;
      height: 24px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.95);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      cursor: pointer;
      outline: none;
    }

    .nav-btn:active {
      transform: translateY(1px) scale(0.98);
    }

    .month-text {
      font-size: 0.82rem;
    }

    .calendar-grid {
      margin-top: 4px;
    }

    .weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 2px;
      margin-bottom: 4px;
      font-size: 0.68rem;
      color: var(--muted);
      text-align: center;
    }

    .days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 4px;
    }

    .day {
      height: 28px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.78rem;
      cursor: pointer;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text);
    }

    .day.outside {
      color: rgba(148, 163, 184, 0.45);
    }

    .day.today {
      border-color: rgba(56, 189, 248, 0.7);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4);
    }

    .day:hover {
      background: rgba(15, 23, 42, 0.9);
      border-color: rgba(148, 163, 184, 0.9);
    }

    .day.selected {
      background: radial-gradient(circle at top, #38bdf8, #0369a1);
      color: #f9fafb;
      border-color: transparent;
      box-shadow: 0 0 18px rgba(56, 189, 248, 0.7);
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="card" id="dateFilterCard">
      <div class="card-inner">
        <div class="header">
          <div class="title-wrap">
            <div class="title">Date Filter</div>
            <div class="subtitle">Quick presets + calendar popover â€“ ideal for analytics dashboards</div>
          </div>
          <div class="badge">Presets + Picker</div>
        </div>

        <div class="presets">
          <button class="preset-btn" data-preset="today" type="button">
            <span class="dot"></span> Today
          </button>
          <button class="preset-btn" data-preset="yesterday" type="button">Yesterday</button>
          <button class="preset-btn" data-preset="last7" type="button">Last 7 days</button>
          <button class="preset-btn" data-preset="last30" type="button">Last 30 days</button>
          <button class="preset-btn" data-preset="thisMonth" type="button">This month</button>
          <button class="preset-btn" data-preset="lastMonth" type="button">Last month</button>
        </div>

        <div class="inputs-row">
          <div class="field">
            <span class="label">From</span>
            <div class="pill-input placeholder" id="fromField">
              <span id="fromText">dd/mm/yyyy</span>
              <div class="pill-icon">ðŸ“…</div>
            </div>
          </div>
          <div class="field">
            <span class="label">To</span>
            <div class="pill-input placeholder" id="toField">
              <span id="toText">dd/mm/yyyy</span>
              <div class="pill-icon">ðŸ“…</div>
            </div>
          </div>
          <div class="field">
            <span class="label">Summary</span>
            <div class="chip" id="summaryChip">No date range selected</div>
          </div>
        </div>

        <div class="footer">
          <span>Tip: use presets for faster filtering, then fine-tune dates with the calendar.</span>
          <button class="apply-btn" type="button">
            Apply filter
            <span>âžœ</span>
          </button>
        </div>

        <!-- Popover Calendar -->
        <div class="popover" id="calendarPopover">
          <div class="popover-inner">
            <div class="popover-header">
              <div class="popover-label" id="popoverLabel">Select date</div>
              <div class="month-nav">
                <button class="nav-btn" id="prevMonthBtnPop" type="button">â€¹</button>
                <span class="month-text" id="monthText">March 2025</span>
                <button class="nav-btn" id="nextMonthBtnPop" type="button">â€º</button>
              </div>
            </div>
            <div class="calendar-grid">
              <div class="weekdays">
                <div>Su</div><div>Mo</div><div>Tu</div><div>We</div><div>Th</div><div>Fr</div><div>Sa</div>
              </div>
              <div class="days" id="daysContainer"></div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <script>
    // Elements
    const fromField = document.getElementById("fromField");
    const toField = document.getElementById("toField");
    const fromText = document.getElementById("fromText");
    const toText = document.getElementById("toText");
    const summaryChip = document.getElementById("summaryChip");
    const presets = document.querySelectorAll(".preset-btn");
    const popover = document.getElementById("calendarPopover");
    const monthText = document.getElementById("monthText");
    const prevMonthBtnPop = document.getElementById("prevMonthBtnPop");
    const nextMonthBtnPop = document.getElementById("nextMonthBtnPop");
    const daysContainer = document.getElementById("daysContainer");
    const popoverLabel = document.getElementById("popoverLabel");
    const card = document.getElementById("dateFilterCard");

    let currentMonthDate = new Date();
    currentMonthDate.setDate(1);

    let activeField = null; // "from" or "to"
    let fromDate = null;
    let toDate = null;

    const monthNames = [
      "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];

    function formatDate(date) {
      if (!date) return "";
      const d = String(date.getDate()).padStart(2, "0");
      const m = String(date.getMonth() + 1).padStart(2, "0");
      const y = date.getFullYear();
      return `${d}/${m}/${y}`;
    }

    function updateSummary() {
      if (!fromDate && !toDate) {
        summaryChip.textContent = "No date range selected";
        return;
      }
      if (fromDate && !toDate) {
        summaryChip.textContent = `From ${formatDate(fromDate)}`;
        return;
      }
      if (fromDate && toDate) {
        summaryChip.textContent = `${formatDate(fromDate)} â†’ ${formatDate(toDate)}`;
      }
    }

    function sameDay(a, b) {
      return a && b &&
        a.getFullYear() === b.getFullYear() &&
        a.getMonth() === b.getMonth() &&
        a.getDate() === b.getDate();
    }

    function renderCalendar() {
      daysContainer.innerHTML = "";
      const year = currentMonthDate.getFullYear();
      const month = currentMonthDate.getMonth();

      monthText.textContent = `${monthNames[month]} ${year}`;

      const firstDayOfMonth = new Date(year, month, 1);
      const lastDayOfMonth = new Date(year, month + 1, 0);
      const prevMonthLastDay = new Date(year, month, 0);

      const startingDayIndex = firstDayOfMonth.getDay();
      const totalDaysInMonth = lastDayOfMonth.getDate();
      const totalDaysInPrevMonth = prevMonthLastDay.getDate();

      const cells = [];
      // prev month tail
      for (let i = startingDayIndex - 1; i >= 0; i--) {
        const dayNum = totalDaysInPrevMonth - i;
        const date = new Date(year, month - 1, dayNum);
        cells.push({ dayNum, date, outside: true });
      }
      // current month
      for (let d = 1; d <= totalDaysInMonth; d++) {
        const date = new Date(year, month, d);
        cells.push({ dayNum: d, date, outside: false });
      }
      // next month head to fill grid to multiple of 7
      let extra = (7 - (cells.length % 7)) % 7;
      for (let d = 1; d <= extra; d++) {
        const date = new Date(year, month + 1, d);
        cells.push({ dayNum: d, date, outside: true });
      }

      const today = new Date();

      cells.forEach((cell) => {
        const el = document.createElement("button");
        el.type = "button";
        el.classList.add("day");
        if (cell.outside) el.classList.add("outside");

        if (sameDay(cell.date, today)) {
          el.classList.add("today");
        }

        if (activeField === "from" && fromDate && sameDay(cell.date, fromDate)) {
          el.classList.add("selected");
        }
        if (activeField === "to" && toDate && sameDay(cell.date, toDate)) {
          el.classList.add("selected");
        }

        el.textContent = cell.dayNum;
        el.addEventListener("click", () => handleDateClick(cell.date));
        daysContainer.appendChild(el);
      });
    }

    function openPopover(fieldName, anchorElement) {
      activeField = fieldName;
      popoverLabel.textContent = fieldName === "from" ? "Select start date" : "Select end date";

      const rect = anchorElement.getBoundingClientRect();
      const cardRect = card.getBoundingClientRect();

      // Position popover relative to card
      const top = rect.bottom - cardRect.top;
      const left = rect.left - cardRect.left;

      popover.style.top = `${top + 4}px`;
      popover.style.left = `${left}px`;

      popover.classList.add("visible");
      renderCalendar();
    }

    function closePopover() {
      popover.classList.remove("visible");
      activeField = null;
    }

    function handleDateClick(date) {
      const clean = new Date(date.getFullYear(), date.getMonth(), date.getDate());

      if (activeField === "from") {
        fromDate = clean;
        fromField.classList.remove("placeholder");
        fromText.textContent = formatDate(clean);
        // if toDate exists and is before fromDate, reset toDate
        if (toDate && toDate < fromDate) {
          toDate = null;
          toField.classList.add("placeholder");
          toText.textContent = "dd/mm/yyyy";
        }
      } else if (activeField === "to") {
        toDate = clean;
        toField.classList.remove("placeholder");
        toText.textContent = formatDate(clean);
        // if fromDate exists and is after toDate, swap
        if (fromDate && fromDate > toDate) {
          const temp = fromDate;
          fromDate = toDate;
          toDate = temp;
          fromText.textContent = formatDate(fromDate);
          toText.textContent = formatDate(toDate);
        }
      }

      updateSummary();
      closePopover();
    }

    // Presets
    function clearPresetActive() {
      presets.forEach((p) => p.classList.remove("active"));
    }

    function applyPreset(type) {
      const today = new Date();
      let start = null;
      let end = null;

      const firstDayOfMonth = (date) => new Date(date.getFullYear(), date.getMonth(), 1);
      const lastDayOfMonth = (date) => new Date(date.getFullYear(), date.getMonth() + 1, 0);

      switch (type) {
        case "today":
          start = new Date(today.getFullYear(), today.getMonth(), today.getDate());
          end = new Date(start);
          break;
        case "yesterday":
          const y = new Date(today);
          y.setDate(y.getDate() - 1);
          start = new Date(y.getFullYear(), y.getMonth(), y.getDate());
          end = new Date(start);
          break;
        case "last7":
          end = new Date(today.getFullYear(), today.getMonth(), today.getDate());
          start = new Date(end);
          start.setDate(start.getDate() - 6);
          break;
        case "last30":
          end = new Date(today.getFullYear(), today.getMonth(), today.getDate());
          start = new Date(end);
          start.setDate(start.getDate() - 29);
          break;
        case "thisMonth":
          start = firstDayOfMonth(today);
          end = lastDayOfMonth(today);
          break;
        case "lastMonth":
          const lm = new Date(today.getFullYear(), today.getMonth() - 1, 1);
          start = firstDayOfMonth(lm);
          end = lastDayOfMonth(lm);
          break;
      }

      fromDate = start;
      toDate = end;

      fromField.classList.remove("placeholder");
      toField.classList.remove("placeholder");
      fromText.textContent = formatDate(fromDate);
      toText.textContent = formatDate(toDate);
      updateSummary();

      currentMonthDate = new Date(start.getFullYear(), start.getMonth(), 1);
      renderCalendar();
    }

    presets.forEach((btn) => {
      btn.addEventListener("click", () => {
        const preset = btn.getAttribute("data-preset");
        clearPresetActive();
        btn.classList.add("active");
        applyPreset(preset);
      });
    });

    // Field clicks
    fromField.addEventListener("click", () => {
      openPopover("from", fromField);
    });

    toField.addEventListener("click", () => {
      openPopover("to", toField);
    });

    // Month nav in popover
    prevMonthBtnPop.addEventListener("click", () => {
      currentMonthDate.setMonth(currentMonthDate.getMonth() - 1);
      renderCalendar();
    });

    nextMonthBtnPop.addEventListener("click", () => {
      currentMonthDate.setMonth(currentMonthDate.getMonth() + 1);
      renderCalendar();
    });

    // Close when clicking outside
    document.addEventListener("click", (e) => {
      if (!card.contains(e.target) || e.target === card) {
        closePopover();
      }
    });

    // Prevent immediate close when clicking inside popover
    popover.addEventListener("click", (e) => {
      e.stopPropagation();
    });

    // Init
    (function init() {
      renderCalendar();
      updateSummary();
    })();
  </script>
</body>
</html>
